<ngb-alert type="danger" [hidden]="!errorMessage" [dismissible]="false">{{ errorMessage }}</ngb-alert>
<button type="button" class="btn btn-outline-dark" (click)="listCryptos()">Search</button>
<div [hidden]="!showSpinner" class="spinner-border" role="status">
  <span class="sr-only">Loading...</span>
</div>
<table class="table table-striped table-bordered table-hover">
  <caption>Total Price: {{ total }}</caption>
  <thead>
    <tr>
      <th scope="col"></th>
      <th scope="col">CMC ID</th>
      <th scope="col">Name</th>
      <th scope="col">Quantity</th>
      <th scope="col">Price</th>
      <th scope="col">Total</th>
      <th scope="col">Remark</th>
    </tr>
  </thead>
  <tbody> 
    <tr *ngFor="let crypto of cryptos">
      <th scope="row">
        <button type="button" class="btn btn-outline-primary mr-md-3" (click)="editDialog(d_edit, crypto)">Edit</button>    
        <button type="button" class="btn btn-outline-danger mr-md-3" (click)="confirmDialog(d_delete, crypto.cmc_id)">Delete</button>         
      </th>
      <td>{{ crypto.cmc_id }}</td>
      <td>{{ crypto.name }}</td>
      <td>{{ crypto.quantity }}</td>
      <td>{{ crypto.price }}</td>
      <td>{{ crypto.total }}</td>
      <td>{{ crypto.remark }}</td>
    </tr>
  </tbody>
</table>
<button type="button" class="btn btn-outline-success" (click)="addDialog(d_edit)">Add</button>

<ng-template #d_delete let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Confirm Deleting</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    Are you sure to delete?
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="modal.close('Save click')">Yes</button>
    <button type="button" class="btn btn-outline-danger" (click)="modal.dismiss('Cross click')">No</button>
  </div>
</ng-template>

<ng-template #d_edit let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{isEdit ? 'Update Crypto' : 'Add Crypto'}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group" [formGroup]="cryptoForm">
      <label for="cmc_id">CMC ID</label>
      <input type="text" id="cmc_id" class="form-control" formControlName="cmc_id">
      <div *ngIf="cmc_id?.invalid && (cmc_id?.dirty || cmc_id?.touched)" class="alert alert-danger">
        <div *ngIf="cmc_id?.errors?.required">
          CMC ID is required.
        </div>
      </div>      
      <label for="name">Name</label>
      <input type="text" id="name" class="form-control" formControlName="name">
      <div *ngIf="name?.invalid && (name?.dirty || name?.touched)" class="alert alert-danger">
        <div *ngIf="name?.errors?.required">
          Name is required.
        </div>
      </div>      
      <label for="quantity">Quantity</label>
      <input id="quantity" class="form-control" formControlName="quantity">
      <div *ngIf="quantity?.invalid && (quantity?.dirty || quantity?.touched)" class="alert alert-danger">
        <div *ngIf="quantity?.errors?.required">
          Quantity is required.
        </div>
      </div>       
      <label for="remark">Remark</label>
      <input id="remark" class="form-control" formControlName="remark">        
    </div>      
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="modal.close('Save click')" [disabled]="cryptoForm.invalid">Yes</button>
    <button type="button" class="btn btn-outline-danger" (click)="modal.dismiss('Cross click')">No</button>
  </div>
</ng-template>