<ngb-alert type="danger" [hidden]="!errorMessage" [dismissible]="false">{{ errorMessage }}</ngb-alert>
<div class="form-group form-inline">
    Name search: <input class="form-control ml-2" type="text" [formControl]="filter"/>
    <button type="button" class="btn btn-outline-dark ml-4" (click)="searchKeys()">Search</button>
    <div [hidden]="!showSpinner" class="spinner-border" role="status">
        <span class="sr-only">Loading...</span>
    </div>    
</div>
<table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col">Key</th>
        <th scope="col">Value</th>
      </tr>
    </thead>
    <tbody> 
      <tr *ngFor="let key of keys">
        <th scope="row">
            <button type="button" class="btn btn-outline-primary mr-md-3" (click)="editDialog(d_edit, key)">Edit</button>    
            <button type="button" class="btn btn-outline-danger mr-md-3" (click)="confirmDialog(d_delete, key.name)">Delete</button>    
        </th>
        <td>{{ key.name }}</td>
        <td>{{ key.key }}</td>
        <td>{{ key.value }}</td>
      </tr>
    </tbody>
</table>
<button type="button" class="btn btn-outline-success" (click)="addDialog(d_edit)">Add</button>

<ng-template #d_delete let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Confirm Deleting</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    Are you sure to delete?
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="modal.close('Save click')">Yes</button>
    <button type="button" class="btn btn-outline-danger" (click)="modal.dismiss('Cross click')">No</button>
  </div>
</ng-template>

<ng-template #d_edit let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{isEdit ? 'Update Key' : 'Add Key'}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group" [formGroup]="keyForm">
      <label for="name">Site Name</label>
      <input type="text" id="name" class="form-control" formControlName="name">
      <div *ngIf="name?.invalid && (name?.dirty || name?.touched)" class="alert alert-danger">
        <div *ngIf="name?.errors?.required">
          Name is required.
        </div>
      </div>      
      <label for="key">Key</label>
      <input id="key" class="form-control" formControlName="key">
      <div *ngIf="key?.invalid && (key?.dirty || key?.touched)" class="alert alert-danger">
        <div *ngIf="key?.errors?.required">
          Key is required.
        </div>
      </div>       
      <label for="value">Value</label>
      <input id="value" class="form-control" formControlName="value">
      <div *ngIf="value?.invalid && (value?.dirty || value?.touched)" class="alert alert-danger">
        <div *ngIf="value?.errors?.required">
          Value is required.
        </div>
      </div>       
    </div>      
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success" (click)="modal.close('Save click')" [disabled]="keyForm.invalid">Yes</button>
    <button type="button" class="btn btn-outline-danger" (click)="modal.dismiss('Cross click')">No</button>
  </div>
</ng-template>